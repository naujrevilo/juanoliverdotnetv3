---
title: Respuesta a Incidentes de Seguridad
description: Procedimientos y planes de respuesta ante incidentes de seguridad.
date: 2025-01-15
categories: ["Manuales"]
tags: ["respuesta a incidentes", "incidentes", "forense", "seguridad"]
---

import SecurityBanner from "../../../components/docs/SecurityBanner.astro";

<SecurityBanner level="high" version="1.0" />

La respuesta a incidentes es un enfoque estructurado para gestionar y mitigar las consecuencias de un incidente de seguridad.

## Fases de Respuesta

### 1. Preparación

Establecer capacidades antes que ocurra un incidente.

**Actividades:**

- Formar equipo de respuesta a incidentes (CSIRT)
- Desarrollar procedimientos documentados
- Implementar herramientas de detección y análisis
- Realizar simulacros periódicos
- Establecer canales de comunicación

**Herramientas esenciales:**

```bash
# Kit de respuesta a incidentes
apt install -y \
  wireshark tcpdump netcat nmap \
  foremost volatility3 autopsy \
  sleuthkit binwalk strings
```

### 2. Detección y Análisis

Identificar y evaluar incidentes de seguridad.

**Indicadores de compromiso (IoC):**

- Tráfico de red anómalo
- Procesos desconocidos ejecutándose
- Modificaciones no autorizadas de archivos
- Inicios de sesión sospechosos
- Alertas de sistemas de seguridad

**Análisis inicial:**

```bash
# Revisar conexiones activas
netstat -tulpn | grep ESTABLISHED

# Procesos sospechosos
ps aux | grep -v "\[" | sort -nrk 3,3 | head -20

# Últimos inicios de sesión
last -i | head -50

# Archivos modificados recientemente
find /etc /var/www -type f -mtime -1 -ls
```

### 3. Contención

Limitar el alcance y impacto del incidente.

**Contención a corto plazo:**

- Aislar sistemas afectados de la red
- Bloquear direcciones IP maliciosas
- Deshabilitar cuentas comprometidas
- Preservar evidencia forense

```bash
# Aislar sistema de la red
iptables -A INPUT -j DROP
iptables -A OUTPUT -j DROP

# Crear imagen forense del disco
dd if=/dev/sda of=/mnt/evidence/disk.img bs=4M conv=noerror,sync
sha256sum /mnt/evidence/disk.img > /mnt/evidence/disk.img.sha256
```

**Contención a largo plazo:**

- Aplicar parches de seguridad
- Cambiar credenciales comprometidas
- Implementar reglas de firewall adicionales

### 4. Erradicación

Eliminar la causa raíz del incidente.

**Acciones:**

- Remover malware y backdoors
- Cerrar vulnerabilidades explotadas
- Eliminar cuentas no autorizadas
- Revocar certificados comprometidos

```bash
# Buscar malware con ClamAV
clamscan -r --infected --remove /var/www

# Eliminar usuario sospechoso
userdel -r usuario_malicioso

# Buscar claves SSH no autorizadas
find /home -name authorized_keys -exec cat {} \;
```

### 5. Recuperación

Restaurar sistemas a operación normal.

**Proceso:**

1. Verificar que amenaza ha sido eliminada
2. Restaurar desde respaldos limpios
3. Monitorear sistemas restaurados
4. Validar funcionalidad
5. Retorno gradual a producción

```bash
# Restaurar desde backup verificado
rsync -avz backup@servidor:/backups/20250101/ /var/www/

# Verificar integridad
sha256sum -c checksums.txt

# Monitoreo intensivo post-restauración
tail -f /var/log/syslog /var/log/auth.log /var/log/apache2/access.log
```

### 6. Lecciones Aprendidas

Documentar y mejorar capacidades de respuesta.

**Reunión post-incidente:**

- ¿Qué sucedió y cuándo?
- ¿Cómo se detectó?
- ¿Qué funcionó bien?
- ¿Qué se puede mejorar?
- ¿Qué acciones preventivas tomar?

## Clasificación de Incidentes

### Niveles de Severidad

| Nivel       | Descripción                   | Tiempo de Respuesta | Ejemplo                              |
| ----------- | ----------------------------- | ------------------- | ------------------------------------ |
| **Crítico** | Impacto masivo en operaciones | Inmediato           | Ransomware en servidores críticos    |
| **Alto**    | Compromiso significativo      | < 1 hora            | Robo de credenciales administrativas |
| **Medio**   | Impacto limitado              | < 4 horas           | Malware en estación de trabajo       |
| **Bajo**    | Impacto mínimo                | < 24 horas          | Intento fallido de phishing          |

## Comunicación Durante Incidentes

### Stakeholders Clave

- **Equipo técnico**: Actualizaciones frecuentes sobre progreso
- **Gerencia**: Informes ejecutivos de impacto y estado
- **Legal**: Notificación de requisitos regulatorios
- **Comunicaciones**: Gestión de relaciones públicas
- **Clientes**: Notificación según obligaciones contractuales

### Plantilla de Comunicación

```markdown
INCIDENTE DE SEGURIDAD - [NIVEL]

Fecha/Hora: [Timestamp]
Incidente ID: [INC-YYYY-NNNN]
Estado: [Activo/Contenido/Resuelto]

RESUMEN:
[Descripción breve del incidente]

IMPACTO:
[Sistemas afectados y consecuencias]

ACCIONES TOMADAS:

- [Acción 1]
- [Acción 2]

PRÓXIMOS PASOS:

- [Paso 1]
- [Paso 2]

CONTACTO:
[Responsable del incidente]
```

## Herramientas de Análisis Forense

### Memoria RAM

```bash
# Capturar volcado de memoria con LiME
insmod lime.ko "path=/mnt/evidence/ram.lime format=lime"

# Analizar con Volatility
volatility -f ram.lime --profile=LinuxUbuntu2004x64 linux_pslist
volatility -f ram.lime --profile=LinuxUbuntu2004x64 linux_netstat
```

### Análisis de Red

```bash
# Capturar tráfico para análisis
tcpdump -i eth0 -w /tmp/capture.pcap

# Analizar con tshark
tshark -r capture.pcap -Y "http.request.method == POST"
```

### Logs

```bash
# Consolidar logs relevantes
grep -r "Failed password" /var/log/auth.log* > failed_logins.txt

# Análisis con logwatch
logwatch --detail High --range today --service sshd
```

## Checklist de Respuesta Rápida

- [ ] Aislar sistemas afectados
- [ ] Preservar evidencia (memoria, disco, logs)
- [ ] Notificar a stakeholders clave
- [ ] Documentar todas las acciones
- [ ] Identificar vector de ataque
- [ ] Evaluar alcance del compromiso
- [ ] Implementar contención
- [ ] Eliminar amenaza
- [ ] Restaurar operaciones
- [ ] Conducir análisis post-incidente
- [ ] Actualizar procedimientos y controles

## Conclusión

Una respuesta efectiva a incidentes requiere preparación, procesos claros y práctica regular. Mantener la calma, seguir procedimientos establecidos y documentar meticulosamente son claves para minimizar el impacto de incidentes de seguridad.
